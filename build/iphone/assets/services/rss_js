var osname=Ti.Platform.osname,RSS_URL="http://avalanche.nhl.com/rss/news.xml",MONTH_MAP={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},getRssText=function(e,t){return osname==="mobileweb"?e.getElementsByTagName(t).item(0).textContent:e.getElementsByTagName(t).item(0).text},parseDate=function(e){var t=e.split(" "),n=t[4].split(":");return t[2]+" "+t[1]},getImageLink=function(e){var t=e,n=e.replace(" ","%20");return n};exports.loadRssFeed=function(e,t){var n=Ti.Network.createHTTPClient();t=t||0,n.open("GET",RSS_URL),n.onload=function(n){var r=this.responseXML;if(r===null||r.documentElement===null){if(t<3){t++,exports.loadRssFeed(e,t);return}alert("Error reading RSS feed. Make sure you have a network connection and try refreshing."),e.error&&e.error();return}var i=r.documentElement.getElementsByTagName("item"),s=[];for(var u=0;u<i.length;u++){var a=i.item(u),f;try{var f=a.getElementsByTagName("enclosure").item(0).getAttribute("url")}catch(n){f="images/nhl.png"}s.push({title:getRssText(a,"title"),link:getRssText(a,"link"),pubDate:parseDate(getRssText(a,"pubDate")),descript:getRssText(a,"description"),image:getImageLink(f)})}e.success&&e.success(s)},n.onerror=function(t){e.error&&e.error()},e.start&&e.start(),n.send()}