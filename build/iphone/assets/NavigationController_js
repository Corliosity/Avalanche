function NavigationController(){this.windowStack=[]}NavigationController.prototype.open=function(e){Ti.API.log("Open function."),this.windowStack.push(e);var t=this,n=e;e.addEventListener("close",function(){if(t.windowStack.length>1){Ti.API.log("Event 'close': "+this.title);var e=t.windowStack.pop();n!=e&&(Ti.API.info("Last window should NOT have been popped. Push it back on the stack!"),t.windowStack.push(e)),this.toClose&&(Ti.API.log("Invoke close on dependent window:"+this.toClose.title),t.navGroup?t.navGroup.close(this.toClose,{animated:!1}):this.toClose.close({animated:!1})),this.toOpen&&(Ti.API.log("Invoke open on dependent window:"+this.toOpen.title),t.open(this.toOpen)),Ti.API.log("End event 'close'. Stack: "+t.windowStack.map(function(e){return e.title}))}}),e.addEventListener("set.to.close",function(e){Ti.API.log("Event 'set.to.close': "+this.title),this.toClose=e.win}),e.addEventListener("set.to.open",function(e){Ti.API.log("Event 'set.to.open': "+this.title),this.toOpen=e.win}),e.navBarHidden=e.navBarHidden||!1;if(this.windowStack.length===1)if(Ti.Platform.osname==="android")e.exitOnClose=!0,e.open();else{this.navGroup=Ti.UI.iPhone.createNavigationGroup({window:e});var r=Ti.UI.createWindow();r.add(this.navGroup),r.open()}else Ti.Platform.osname==="android"?e.open():this.navGroup.open(e);Ti.API.log("End Open. Stack: "+this.windowStack.map(function(e){return e.title}))},NavigationController.prototype.home=function(){Ti.API.log("Home function.");if(this.windowStack.length>1){for(var e=this.windowStack.length-1;e>1;e--)this.windowStack[e].fireEvent("set.to.close",{win:this.windowStack[e-1]});this.navGroup?this.navGroup.close(this.windowStack[this.windowStack.length-1]):this.windowStack[this.windowStack.length-1].close()}Ti.API.log("End Home. Stack: "+this.windowStack.map(function(e){return e.title}))},NavigationController.prototype.openFromHome=function(e){Ti.API.log("openFromHome function."),this.windowStack.length==1?this.open(e):(this.windowStack[1].fireEvent("set.to.open",{win:e}),this.home()),Ti.API.log("End openFromHome. Stack: "+this.windowStack.map(function(e){return e.title}))},module.exports=NavigationController